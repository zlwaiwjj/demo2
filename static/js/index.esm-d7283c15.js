import{v as W}from"./runtime-dom.esm-bundler-7421a035.js";import{h as y,r as _,a as w,J as F,w as N,G as K,p as B,y as U,D as d,R as X,E as j,e as Y,f as q,I as G}from"./runtime-core.esm-bundler-1f6332ae.js";var L=function(e,t){var u,n=t.arg;if(!n){console.error("参数有误");return}var s=t.value,c=Y(n)?n.value:(u=t.instance)===null||u===void 0?void 0:u.$refs[n];if(!c){console.error("没有找到 ".concat(n," 对应的实例"));return}if(typeof c.addReference!="function"){console.error("".concat(n," 对应的实例不是 VContextmenu"));return}e.$contextmenuKey=n,c.addReference(e,s)},H=function(e,t){var u,n=e.$contextmenuKey;if(n){var s=(u=t.instance)===null||u===void 0?void 0:u.$refs[n];s==null||s.removeReference(e)}},J=function(e,t){H(e,t),L(e,t)},ne={mounted:L,updated:J,beforeUnmount:H},o={contextmenu:"v-contextmenu",contextmenuIcon:"v-contextmenu-icon",contextmenuInner:"v-contextmenu-inner",contextmenuDivider:"v-contextmenu-divider",contextmenuItem:"v-contextmenu-item",contextmenuItemHover:"v-contextmenu-item--hover",contextmenuItemDisabled:"v-contextmenu-item--disabled",contextmenuGroup:"v-contextmenu-group",contextmenuGroupTitle:"v-contextmenu-group__title",contextmenuGroupMenus:"v-contextmenu-group__menus",contextmenuSubmenu:"v-contextmenu-submenu",contextmenuSubmenuTitle:"v-contextmenu-submenu__title",contextmenuSubmenuMenus:"v-contextmenu-submenu__menus",contextmenuSubmenuMenusTop:"v-contextmenu-submenu__menus--top",contextmenuSubmenuMenusRight:"v-contextmenu-submenu__menus--right",contextmenuSubmenuMenusBottom:"v-contextmenu-submenu__menus--bottom",contextmenuSubmenuMenusLeft:"v-contextmenu-submenu__menus--left",contextmenuSubmenuArrow:"v-contextmenu-submenu__arrow"};function z(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Object]"&&!q(r)}var Q={trigger:["contextmenu"]},ue=y({name:"VContextmenu",props:{modelValue:{type:Boolean,default:!1},autoAjustPlacement:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},teleport:{type:[String,Object],default:function(){return"body"}}},emits:["show","hide","update:modelValue"],setup:function(e,t){var u=t.emit,n=_(null),s=_(e.modelValue||!1),c=function(l){s.value=l,u("update:modelValue",l)},x=_({top:0,left:0}),M=w(function(){return{top:"".concat(x.value.top,"px"),left:"".concat(x.value.left,"px")}}),$=_(null),m=function(l,v){var a=l instanceof Event?v:l,I=(a==null?void 0:a.autoAjustPlacement)||e.autoAjustPlacement,h={top:(a==null?void 0:a.top)||0,left:(a==null?void 0:a.left)||0};if(l instanceof Event){var R,k;l.preventDefault(),h.top=(R=a==null?void 0:a.top)!==null&&R!==void 0?R:l.pageY,h.left=(k=a==null?void 0:a.left)!==null&&k!==void 0?k:l.pageX}c(!0),G(function(){if(I){var O=n.value;if(!O)return;var P=O.clientWidth,V=O.clientHeight;if(V+h.top>=window.innerHeight+window.scrollY){var D=h.top-V;D>window.scrollY&&(h.top=D)}if(P+h.left>=window.innerWidth+window.scrollX){var T=h.left-P;T>window.scrollX&&(h.left=T)}}x.value=h,u("show")})},b=function(){$.value=null,c(!1),u("hide")},i=F(new Map),p=_(),g=w(function(){return p.value&&i.get(p.value)}),A=function(l,v){var a=function(){return v!=null&&v.trigger?Array.isArray(v.trigger)?v.trigger:[v.trigger]:Q.trigger}(),I=function(R){e.disabled||(p.value=l,m(R,{}))};a.forEach(function(h){l.addEventListener(h,I)}),i.set(l,{triggers:a,handler:I})},E=function(l){var v=i.get(l);v&&(v.triggers.forEach(function(a){l.removeEventListener(a,v.handler)}),i.delete(l))},S=function(l){if(!(!l.target||!n.value||!p.value)){var v=n.value.contains(l.target)||g.value&&g.value.triggers.includes("click")&&p.value.contains(l.target);v||c(!1)}};return N(s,function(C){C?document.addEventListener("click",S):document.removeEventListener("click",S)}),K(function(){document.removeEventListener("click",S)}),B("visible",s),B("autoAjustPlacement",e.autoAjustPlacement),B("show",m),B("hide",b),{visible:s,style:M,currentReferenceOptions:g,currentOptions:$,contextmenuRef:n,addReference:A,removeReference:E,toggle:c,show:m,hide:b}},methods:{renderContent:function(){var e,t;return U(d("div",{class:o.contextmenu,ref:"contextmenuRef",style:this.style},[d("ul",{class:o.contextmenuInner},[(e=(t=this.$slots).default)===null||e===void 0?void 0:e.call(t,{triggerOptions:"currentReferenceOptions",options:"currentOptions"})])]),[[W,"visible"]])}},render:function(){var e;return this.visible?this.teleport?d(X,{to:this.teleport},z(e=this.renderContent())?e:{default:function(){return[e]}}):this.renderContent():null}});function f(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var re=y({name:"VContextmenuItem",props:{disabled:{type:Boolean,default:!1},hideOnClick:{type:Boolean,default:!0}},emits:["click","mouseenter","mouseleave"],setup:function(e,t){var u=t.emit,n=j("hide"),s=_(!1),c=w(function(){var m;return m={},f(m,o.contextmenuItem,!0),f(m,o.contextmenuItemDisabled,e.disabled),f(m,o.contextmenuItemHover,s.value),m}),x=function(b){e.disabled||(u("click",b),e.hideOnClick&&(n==null||n()))},M=function(b){e.disabled||(s.value=!0,u("mouseenter",b))},$=function(b){e.disabled||(s.value=!1,u("mouseleave",b))};return{classes:c,handleClick:x,handleMouseenter:M,handleMouseleave:$}},render:function(){var e,t;return d("li",{class:this.classes,onClick:this.handleClick,onMouseenter:this.handleMouseenter,onMouseleave:this.handleMouseleave},[(e=(t=this.$slots).default)===null||e===void 0?void 0:e.call(t)])}}),oe=y({name:"VContextmenuDivider",render:function(){return d("li",{class:o.contextmenuDivider},null)}}),Z=y({name:"VContextmenuIcon",props:{name:{type:String,required:!0}},render:function(){return d("i",{class:[o.contextmenuIcon,"".concat(o.contextmenuIcon,"-").concat(this.name)]},null)}}),ie=y({name:"VContextmenuSubmenu",props:{title:{type:String,required:!0},disabled:{type:Boolean,default:!1}},emits:["mouseenter","mouseleave"],setup:function(e,t){var u=t.emit,n=_(null),s=j("autoAjustPlacement"),c=_(["top","right"]),x=_(!1),M=function(p){e.disabled||(x.value=!0,u("mouseenter",p),G(function(){var g=[];if(s){var A=p.target,E=A.getBoundingClientRect();if(!n.value)return;var S=n.value.clientWidth,C=n.value.clientHeight;E.right+S>=window.innerWidth?g.push("left"):g.push("right"),E.bottom+C>=window.innerHeight?g.push("bottom"):g.push("top")}c.value=g}))},$=function(p){e.disabled||(x.value=!1,u("mouseleave",p))},m=w(function(){var i;return i={},f(i,o.contextmenuItem,!0),f(i,o.contextmenuSubmenuTitle,!0),f(i,o.contextmenuItemHover,x.value),f(i,o.contextmenuItemDisabled,e.disabled),i}),b=w(function(){var i;return i={},f(i,o.contextmenu,!0),f(i,o.contextmenuSubmenuMenus,!0),f(i,o.contextmenuSubmenuMenusTop,c.value.includes("top")),f(i,o.contextmenuSubmenuMenusRight,c.value.includes("right")),f(i,o.contextmenuSubmenuMenusBottom,c.value.includes("bottom")),f(i,o.contextmenuSubmenuMenusLeft,c.value.includes("left")),i});return{hover:x,submenuRef:n,titleClasses:m,menusClasses:b,handleMouseenter:M,handleMouseleave:$}},render:function(){var e,t,u,n;return d("li",{class:o.contextmenuSubmenu,onMouseenter:this.handleMouseenter,onMouseleave:this.handleMouseleave},[d("div",{class:this.titleClasses},[((e=(t=this.$slots).title)===null||e===void 0?void 0:e.call(t))||this.title,d("span",{class:o.contextmenuSubmenuArrow},[d(Z,{name:"right-arrow"},null)])]),this.hover?d("div",{ref:"submenuRef",class:this.menusClasses},[d("ul",{class:o.contextmenuInner},[(u=(n=this.$slots).default)===null||u===void 0?void 0:u.call(n)])]):null])}}),le=y({name:"VContextmenuGroup",props:{title:{type:String,default:void 0},maxWidth:{type:[Number,String],default:void 0}},setup:function(e){var t=w(function(){if(e.maxWidth)return{"max-width":typeof e.maxWidth=="number"?"".concat(e.maxWidth,"px"):e.maxWidth,"overflow-x":"auto"}});return{style:t}},methods:{renderTitle:function(){var e,t,u=((e=(t=this.$slots).title)===null||e===void 0?void 0:e.call(t))||this.title;return u?d("div",{class:o.contextmenuGroupTitle},[u]):null}},render:function(){var e,t;return d("li",{class:o.contextmenuGroup},[this.renderTitle(),d("ul",{style:this.style,class:o.contextmenuGroupMenus},[(e=(t=this.$slots).default)===null||e===void 0?void 0:e.call(t)])])}});export{ue as C,re as a,oe as b,ie as c,le as d,ne as e};
